######### PHP-deployment ##############
replicaCount: 2
namespace: dev
labels:
  dp: dp-nginx-php
  web: nginx-php
  tier: front-end
  ns: web-ns

image:
  php:
    repository: deepcloudmosphere/dp-nginx-php
    tag: phpfpm-code
  nginx:
    repository: nginx
    tag: latest

containers:
  php:
    name: php-ctr
    resources:
      requests:
        memory: "100Mi"
        cpu: "150m"
      limits:
        cpu: "400m"
        memory: "200Mi"

  nginx:
    name: nginx-ctr
    resources:
      requests:
        memory: "100Mi"
        cpu: "150m"
      limits:
        cpu: "400m"
        memory: "200Mi"

ports:
  nginx: 80
  php: 9000

## node affinity
nodeAffinity:
  key: node
  operator: In
  values:
    - kubenode02
    - kubemaster
    - minikube

## toleration

tolerations:
  a:
    key: "color"
    operator: "Equal"
    value: "blue"
    effect: "NoSchedule"
    # tolerationSeconds: 10
  b:
    key: "node-role.kubernetes.io/control-plane"
    operator: "Exists"
    effect: "NoSchedule"
    # tolerationSeconds: 10

## cpu and memory limit
cpu:
  name: cpu-limit-range
  limits:
    default:
      cpu: "300m"
    defaultRequest:
      cpu: "100m"
    type: Container

mem:
  name: mem-limit-range
  limits:
    default:
      memory: "300Mi"
    defaultRequest:
      memory: "100Mi"
    type: Container

## Volumes

volumes:
  vol1: nginx-config-volume
  vol2: shared-files

volumeMounts:
  web: /var/www/html/
  nginxConf: /etc/nginx/conf.d/
## ConfigMap

configmap:
  nginx: nginx-config
  phpdb: php-db-configmap
  dbHost:
    statefullName: mariadb-st-0
    name: db-h
    namespace: db
    domain: svc.cluster.local

  dbUser: deepak

## secret

secret:
  phpdb: php-db-secret
  passwd: ZGVlcGFrMTIz
  db: ZWNvbWRi

## Service

service:
  port: 80
  targetPort: 80
  nodePort: 30006

########### Ingress #######################

ingress:
  create: false
  namespace: ingress-nginx
  name: ingress-php
  class: "nginx"
  rewriteTarget: /
  path: /
  backend:
    service:
      name: php-service-external
      port: 80
